(()=>{"use strict";!function(e){const t=document.createElement("div");t.className="card";const n=document.createElement("div");n.className="search";const c=document.createElement("input");c.type="text",c.placeholder="enter city name",c.spellcheck="false";const a=document.createElement("button");a.innerHTML="search";const o=document.createElement("div");o.className="weather";const l=document.createElement("img");l.className="city-map";const i=document.createElement("h1");i.className="temp";const r=document.createElement("h2");r.className="city";const s=document.createElement("div");s.id="list",n.appendChild(c),n.appendChild(a),o.appendChild(l),o.appendChild(i),o.appendChild(r),t.appendChild(n),t.appendChild(o),t.appendChild(s),e.appendChild(t)}(document.querySelector("body")),function(e){const t=document.createElement("link");t.rel="stylesheet",t.href="style.css",e.appendChild(t)}(document.getElementsByTagName("head")[0]);const e=document.querySelector(".search input"),t=document.querySelector(".search button"),n="8dd53d90-bf9b-4ee4-ac9d-86c1dabd0561",c=document.querySelector(".city-map");let a,o=null,l=null;const i=document.querySelector("#list");async function r(e,t){try{const a=await fetch("https://api.openweathermap.org/data/2.5/weather?units=metric&q="+e+"&appid=6c747baf75682efc7b620568f3236f69"),o=await a.json();document.querySelector(".city").innerHTML=o.name,document.querySelector(".temp").innerHTML=`${Math.round(o.main.temp)}°C`,c.src=`https://static-maps.yandex.ru/v1?spn=0.316457,0.00619&l=map&size=200,200&ll=${o.coord.lon},${o.coord.lat}&apikey=${n}`,t(e)}catch(e){return null}}async function s(e){function t(e){localStorage.setItem("item",JSON.stringify(e))}function n(e,t){e.innerHTML=`<ol>${t.map((e=>`<li>${e}</li>`)).join("")}</ol>`}const c=await async function(){try{const e=JSON.parse(localStorage.getItem("item"));return null===e?[]:e}catch(e){return null}}(),a=[],o=[];if(c.forEach((e=>{a.includes(e)||a.push(e)})),a.forEach((e=>{o.push(e.toLowerCase())})),e)if(a.length>=10){-1===o.indexOf(e.toLowerCase())&&(a.push(e),a.splice(0,a.length-10)),t(a);try{n(i,a)}catch{return null}}else{-1===o.indexOf(e.toLowerCase())&&a.push(e),t(a);try{n(i,a)}catch{return null}}else try{n(i,a)}catch{return null}}!async function(){await async function(){try{const e=await fetch("https://api.geoapify.com/v1/ipinfo?&apiKey=d91fc6ae1d7e4f689781a5d3401fc83f"),t=await e.json();a=t.city.name,o=t.location.latitude,l=t.location.longitude}catch(e){return null}}();try{const e=`https://api.openweathermap.org/data/2.5/weather?units=metric&q=${a}&appid=6c747baf75682efc7b620568f3236f69`,t=await fetch(e),i=await t.json();document.querySelector(".temp").innerHTML=`${Math.round(i.main.temp,0)}°C`,c.src=`https://static-maps.yandex.ru/v1?spn=0.316457,0.00619&l=map&size=200,200&ll=${l},${o}&apikey=${n}`,document.querySelector(".city").innerHTML=a}catch(e){return null}}(),s(),window.onload=function(){t.addEventListener("click",(()=>{r(e.value,s)}))},i&&(i.onclick=function(e){const{target:t}=e;r(t.innerHTML)})})();